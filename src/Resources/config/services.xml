<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">
    <services>
        <defaults public="false" autoconfigure="false" autowire="false"/>

        <!-- Alias generator -->
        <service id="hofff_contao_contact_profiles.alias_generator" class="Ausi\SlugGenerator\SlugGenerator">
            <argument>%hofff_contao_contact_profiles.alias_options%</argument>
        </service>

        <!-- Migration -->
        <service id="Hofff\Contao\ContactProfiles\Migration\ContactProfileElementMigration">
            <argument type="service" id="database_connection"/>
            <argument>%hofff_contao_contact_profiles.sources%</argument>
            <tag name="contao.migration"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Migration\ContactProfileModuleMigration">
            <argument type="service" id="database_connection"/>
            <argument>%hofff_contao_contact_profiles.sources%</argument>
            <tag name="contao.migration"/>
        </service>

        <!-- Url Generator -->
        <service id="Hofff\Contao\ContactProfiles\Routing\ContactProfileUrlGenerator" public="true">
            <argument type="service" id="contao.framework"/>
            <argument type="service" id="router"/>
            <argument type="service" id="Hofff\Contao\ContactProfiles\Model\Category\CategoryRepository"/>
            <argument>%contao.preview_script%</argument>
        </service>

        <!-- Renderer -->
        <service id="Hofff\Contao\ContactProfiles\Renderer\ContactProfileRendererFactory" public="true">
            <argument type="service" id="translator"/>
            <argument type="service" id="Hofff\Contao\Consent\Bridge\ConsentId\ConsentIdParser"/>
            <argument type="service" id="Hofff\Contao\ContactProfiles\Renderer\FieldRenderer"/>
            <argument type="service" id="Hofff\Contao\ContactProfiles\Routing\ContactProfileUrlGenerator"/>
            <argument type="service" id="netzmacht.contao_toolkit.routing.scope_matcher"/>
        </service>

        <!-- Field renderer -->
        <service id="Hofff\Contao\ContactProfiles\Renderer\FieldRenderer"
                 class="Hofff\Contao\ContactProfiles\Renderer\Field\CompositeFieldRenderer"
                 public="true">
            <argument type="service" id="contao.framework"/>
            <argument type="collection"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Renderer\Field\ImageFieldRenderer">
            <argument type="service" id="contao.framework"/>
            <argument type="string">%kernel.project_dir%</argument>
            <tag name="hofff_contao_contact_profiles.field_renderer" field="image"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Renderer\Field\EmailFieldRenderer">
            <argument type="service" id="contao.framework"/>
            <argument type="string">%kernel.project_dir%</argument>
            <tag name="hofff_contao_contact_profiles.field_renderer" field="email"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Renderer\Field\SocialAccountsRenderer">
            <argument type="service" id="contao.framework"/>
            <argument type="service" id="Hofff\Contao\ContactProfiles\Model\SocialAccount\SocialAccountRepository"/>
            <tag name="hofff_contao_contact_profiles.field_renderer" field="accounts"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Renderer\Field\ResponsibilitiesRenderer">
            <argument type="service" id="contao.framework"/>
            <argument type="service" id="Hofff\Contao\ContactProfiles\Model\Responsibility\ResponsibilityRepository"/>
            <tag name="hofff_contao_contact_profiles.field_renderer" field="responsibilities"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Renderer\Field\JumpToFieldRenderer">
            <argument type="service" id="contao.framework"/>
            <tag name="hofff_contao_contact_profiles.field_renderer" field="jumpTo"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Renderer\Field\WebsiteFieldRenderer">
            <argument type="service" id="contao.framework"/>
            <tag name="hofff_contao_contact_profiles.field_renderer" field="website"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Renderer\Field\VideosFieldRenderer">
            <argument type="service" id="contao.framework"/>
            <argument type="service" id="Hofff\Contao\Consent\Bridge\ConsentToolManager"/>
            <tag name="hofff_contao_contact_profiles.field_renderer" field="videos"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Renderer\Field\GalleryFieldRenderer">
            <argument type="service" id="contao.framework"/>
            <argument>%kernel.project_dir%</argument>
            <tag name="hofff_contao_contact_profiles.field_renderer" field="gallery"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Picker\ContactProfilePickerProvider">
            <argument type="service" id="knp_menu.factory"/>
            <argument type="service" id="router"/>
            <argument type="service" id="translator" on-invalid="null"/>
            <argument type="service" id="security.helper"/>
            <argument type="service" id="Hofff\Contao\ContactProfiles\Model\Profile\ProfileRepository"/>
            <tag name="contao.picker_provider"/>
        </service>

        <!-- Social tags -->
        <service id="Hofff\Contao\ContactProfiles\SocialTags\ContactProfileExtractor">
            <argument type="service" id="contao.framework"/>
            <argument type="service" id="request_stack"/>
            <argument>%kernel.project_dir%</argument>
            <tag name="Hofff\Contao\SocialTags\Data\Extractor"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\SocialTags\SocialTagsGenerator" public="true">
            <argument type="service" id="request_stack"/>
            <argument type="service" id="Hofff\Contao\SocialTags\Data\SocialTagsFactory" on-invalid="ignore"/>
        </service>

        <!-- Providers -->
        <service id="Hofff\Contao\ContactProfiles\Provider\ProfileProvider"
                 class="Hofff\Contao\ContactProfiles\Provider\CompositeProfileProvider">
            <argument type="tagged_iterator" tag="hofff_contact_profiles.provider"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Provider\CustomProfileProvider">
            <argument type="service" id="Hofff\Contao\ContactProfiles\Model\Profile\ProfileRepository"/>
            <tag name="hofff_contact_profiles.provider"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Provider\CategoriesProfileProvider">
            <argument type="service" id="Hofff\Contao\ContactProfiles\Model\Profile\ProfileRepository"/>
            <tag name="hofff_contact_profiles.provider"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Provider\DynamicProfileProvider">
            <argument type="service" id="event_dispatcher"/>
            <tag name="hofff_contact_profiles.provider"/>
        </service>

        <!--Fragments -->
        <service id="Hofff\Contao\ContactProfiles\Frontend\Profile\ContactProfileListController">
            <argument type="service" id="netzmacht.contao_toolkit.template_renderer"/>
            <argument type="service" id="netzmacht.contao_toolkit.routing.scope_matcher"/>
            <argument type="service" id="netzmacht.contao_toolkit.response_tagger"/>
            <argument type="service" id="router"/>
            <argument type="service" id="translator"/>
            <argument type="service" id="contao.security.token_checker"/>
            <argument type="service" id="Hofff\Contao\ContactProfiles\Provider\ProfileProvider"/>
            <argument type="service" id="Hofff\Contao\ContactProfiles\Renderer\ContactProfileRendererFactory"/>
            <argument type="service" id="netzmacht.contao_toolkit.contao.config_adapter"/>
            <argument type="service" id="netzmacht.contao_toolkit.contao.input_adapter"/>
            <tag name="contao.content_element"
                 type="hofff_contact_profile_list"
                 category="hofff_contact_profiles"
                 method="renderAsContentElement"/>
            <tag name="contao.frontend_module"
                 type="hofff_contact_profile_list"
                 category="hofff_contact_profiles"
                 method="renderAsFrontendModule"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Frontend\Profile\ContactProfileDetailController">
            <argument type="service" id="netzmacht.contao_toolkit.template_renderer"/>
            <argument type="service" id="netzmacht.contao_toolkit.routing.scope_matcher"/>
            <argument type="service" id="netzmacht.contao_toolkit.response_tagger"/>
            <argument type="service" id="router"/>
            <argument type="service" id="translator"/>
            <argument type="service" id="contao.security.token_checker"/>
            <argument type="service" id="Hofff\Contao\ContactProfiles\Model\Profile\ProfileRepository"/>
            <argument type="service" id="event_dispatcher"/>
            <argument type="service" id="Hofff\Contao\ContactProfiles\Renderer\ContactProfileRendererFactory"/>
            <argument type="service" id="netzmacht.contao_toolkit.contao.input_adapter"/>
            <tag name="contao.content_element"
                 type="hofff_contact_profile_detail"
                 category="hofff_contact_profiles"
                 method="renderAsContentElement"/>
            <tag name="contao.frontend_module"
                 type="hofff_contact_profile_detail"
                 category="hofff_contact_profiles"
                 method="renderAsFrontendModule"/>
        </service>

        <service id="Hofff\Contao\ContactProfiles\Frontend\Profile\ContactProfileInitialsFilterController">
            <argument type="service" id="netzmacht.contao_toolkit.template_renderer"/>
            <argument type="service" id="netzmacht.contao_toolkit.routing.scope_matcher"/>
            <argument type="service" id="netzmacht.contao_toolkit.response_tagger"/>
            <argument type="service" id="router"/>
            <argument type="service" id="translator"/>
            <argument type="service" id="contao.security.token_checker"/>
            <argument type="service" id="Hofff\Contao\ContactProfiles\Provider\ProfileProvider"/>
            <argument type="service" id="netzmacht.contao_toolkit.contao.input_adapter"/>
            <tag name="contao.content_element"
                 type="hofff_contact_profile_initials_filter"
                 category="hofff_contact_profiles"
                 method="renderAsContentElement"/>
            <tag name="contao.frontend_module"
                 type="hofff_contact_profile_initials_filter"
                 category="hofff_contact_profiles"
                 method="renderAsFrontendModule"/>
        </service>

        <!-- Pages -->
        <service id="Hofff\Contao\ContactProfiles\Controller\ContactProfilePageController">
            <argument type="service" id="Hofff\Contao\ContactProfiles\Model\Profile\ProfileRepository"/>
        </service>
    </services>
</container>
